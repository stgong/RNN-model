Using TensorFlow backend.
2019-12-01 19:44:28.188624: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
WARNING:tensorflow:From /Users/xun/Library/Python/3.7/lib/python/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /Users/xun/Library/Python/3.7/lib/python/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
Epoch 1/10
Opening file (1)
Opening file (1)
Opening file (2)
Opening file (3)
Opening file (4)
Opening file (5)
Opening file (6)
Opening file (7)
Opening file (8)
Opening file (9)
Opening file (10)
Opening file (11)
Opening file (12)
Opening file (13)
Opening file (14)
Opening file (15)
Opening file (16)
Opening file (17)
Opening file (18)
Opening file (19)
Opening file (20)
Opening file (21)
Opening file (22)
Opening file (2)
 - 4216s - loss: 6.9331 - val_loss: 6.9710

Epoch 00001: val_loss improved from inf to 6.97096, saving model to /Users/xun/Documents/Thesis/RNN-model/Dataset/ks-cooks-1y/models/rnn_cce_ml60_bs32_ne0.0_gc100_e100_h100_Ug_lr0.1_nt1.hdf5
Epoch 2/10
Opening file (23)
Opening file (24)
Opening file (25)
Opening file (26)
Opening file (27)
Opening file (28)
Opening file (29)
Opening file (30)
Opening file (31)
Opening file (32)
Opening file (33)
Opening file (34)
Opening file (35)
Opening file (36)
Opening file (37)
Opening file (38)
Opening file (39)
Opening file (40)
Opening file (41)
Opening file (42)
Opening file (43)
 - 322s - loss: 6.7879 - val_loss: 6.7883

Epoch 00002: val_loss improved from 6.97096 to 6.78834, saving model to /Users/xun/Documents/Thesis/RNN-model/Dataset/ks-cooks-1y/models/rnn_cce_ml60_bs32_ne0.0_gc100_e100_h100_Ug_lr0.1_nt1.hdf5
Epoch 3/10
Opening file (44)
Opening file (45)
Opening file (46)
Opening file (47)
Opening file (48)
Opening file (49)
Opening file (50)
Opening file (51)
Opening file (52)
Opening file (53)
Opening file (54)
Opening file (55)
Opening file (56)
Opening file (57)
Opening file (58)
Opening file (59)
Opening file (60)
Opening file (61)
Opening file (62)
Opening file (63)
Opening file (64)
Opening file (3)
 - 320s - loss: 6.6463 - val_loss: 6.7861

Epoch 00003: val_loss improved from 6.78834 to 6.78613, saving model to /Users/xun/Documents/Thesis/RNN-model/Dataset/ks-cooks-1y/models/rnn_cce_ml60_bs32_ne0.0_gc100_e100_h100_Ug_lr0.1_nt1.hdf5
Epoch 4/10
Opening file (65)
Opening file (66)
Opening file (67)
Opening file (68)
Opening file (69)
Opening file (70)
Opening file (71)
Opening file (72)
Opening file (73)
Opening file (74)
Opening file (75)
Opening file (76)
Opening file (77)
Opening file (78)
Opening file (79)
Opening file (80)
Opening file (81)
Opening file (82)
Opening file (83)
Opening file (84)
Opening file (85)
Opening file (4)
 - 315s - loss: 6.5380 - val_loss: 6.7279

Epoch 00004: val_loss improved from 6.78613 to 6.72793, saving model to /Users/xun/Documents/Thesis/RNN-model/Dataset/ks-cooks-1y/models/rnn_cce_ml60_bs32_ne0.0_gc100_e100_h100_Ug_lr0.1_nt1.hdf5
Epoch 5/10
Opening file (86)
Opening file (87)
Opening file (88)
Opening file (89)
Opening file (90)
Opening file (91)
Opening file (92)
Opening file (93)
Opening file (94)
Opening file (95)
Opening file (96)
Opening file (97)
Opening file (98)
Opening file (99)
Opening file (100)
Opening file (101)
Opening file (102)
Opening file (103)
Opening file (104)
Opening file (105)
Opening file (106)
 - 320s - loss: 6.4571 - val_loss: 6.8419

Epoch 00005: val_loss did not improve from 6.72793
Epoch 6/10
Opening file (107)
Opening file (108)
Opening file (109)
Opening file (110)
Opening file (111)
Opening file (112)
Opening file (113)
Opening file (114)
Opening file (115)
Opening file (116)
Opening file (117)
Opening file (118)
Opening file (119)
Opening file (120)
Opening file (121)
Opening file (122)
Opening file (123)
Opening file (124)
Opening file (125)
Opening file (126)
Opening file (127)
Opening file (5)
 - 334s - loss: 6.3794 - val_loss: 6.8103

Epoch 00006: val_loss did not improve from 6.72793
Epoch 7/10
Opening file (128)
Opening file (129)
Opening file (130)
Opening file (131)
Opening file (132)
Opening file (133)
Opening file (134)
Opening file (135)
Opening file (136)
Opening file (137)
Opening file (138)
Opening file (139)
Opening file (140)
Opening file (141)
Opening file (142)
Opening file (143)
Opening file (144)
Opening file (145)
Opening file (146)
Opening file (147)
Opening file (148)
Opening file (6)
 - 327s - loss: 6.3173 - val_loss: 6.8302

Epoch 00007: val_loss did not improve from 6.72793
Epoch 8/10
Opening file (149)
Opening file (150)
Opening file (151)
Opening file (152)
Opening file (153)
Opening file (154)
Opening file (155)
Opening file (156)
Opening file (157)
Opening file (158)
Opening file (159)
Opening file (160)
Opening file (161)
Opening file (162)
Opening file (163)
Opening file (164)
Opening file (165)
Opening file (166)
Opening file (167)
Opening file (168)
Opening file (169)
 - 327s - loss: 6.2576 - val_loss: 6.7947

Epoch 00008: val_loss did not improve from 6.72793
Epoch 9/10
Opening file (170)
Opening file (171)
Opening file (172)
Opening file (173)
Opening file (174)
Opening file (175)
Opening file (176)
Opening file (177)
Opening file (178)
Opening file (179)
Opening file (180)
Opening file (181)
Opening file (182)
Opening file (183)
Opening file (184)
Opening file (185)
Opening file (186)
Opening file (187)
Opening file (188)
Opening file (189)
Opening file (190)
Opening file (7)
 - 325s - loss: 6.2114 - val_loss: 6.8306

Epoch 00009: val_loss did not improve from 6.72793
Epoch 10/10
Opening file (191)
Opening file (192)
Opening file (193)
Opening file (194)
Opening file (195)
Opening file (196)
Opening file (197)
Opening file (198)
Opening file (199)
Opening file (200)
Opening file (201)
Opening file (202)
Opening file (203)
Opening file (204)
Opening file (205)
Opening file (206)
Opening file (207)
Opening file (208)
Opening file (209)
Opening file (210)
Opening file (211)
Opening file (212)
Opening file (8)
 - 326s - loss: 6.1704 - val_loss: 6.7259

Epoch 00010: val_loss improved from 6.72793 to 6.72590, saving model to /Users/xun/Documents/Thesis/RNN-model/Dataset/ks-cooks-1y/models/rnn_cce_ml60_bs32_ne0.0_gc100_e100_h100_Ug_lr0.1_nt1.hdf5
[6.93313327550888, 6.787873991107941, 6.64627302904129, 6.537979274368286, 6.457140041351319, 6.379391920852661, 6.317333615970612, 6.2575834719657895, 6.211396044206619, 6.170398018550872]
Opening file (1)
RNN with categorical cross entropy 0 batchs,  7134.726996898651  epochs in 7140.38001203537 s
Last train cost :  6.4698502682924275
recall :  0.042558498001615784
precision :  0.07027027027027051
sps :  0.05405405405405406
Best  sps :  0.05405405405405406
user_coverage :  0.4578696343402226
item_coverage :  131
ndcg :  0.07245011365797642
blockbuster_share :  0.43665158371040724
-----------------
Save model in /Users/xun/Documents/Thesis/RNN-model/Dataset/ks-cooks-1y/models/rnn_cce_ml60_bs32_ne7134.727_gc100_e100_h100_Ug_lr0.1_nt1.hdf5
