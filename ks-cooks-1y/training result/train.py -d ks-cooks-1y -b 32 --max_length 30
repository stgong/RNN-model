/usr/local/Cellar/python/3.7.2_2/bin/python3.7 /Users/xun/Documents/Thesis/Improving-RNN-recommendation-model/train.py -d ks-cooks-1y -b 32 --max_length 30
Using TensorFlow backend.
2019-09-07 22:46:50.860170: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
WARNING:tensorflow:From /Users/xun/Library/Python/3.7/lib/python/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /Users/xun/Library/Python/3.7/lib/python/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
/usr/local/lib/python3.7/site-packages/keras/engine/training_generator.py:47: UserWarning: Using a generator with `use_multiprocessing=True` and multiple workers may duplicate your data. Please consider using the`keras.utils.Sequence class.
  UserWarning('Using a generator with `use_multiprocessing=True`'
Epoch 1/10
Opening file (1)
Opening file (1)
Opening file (1)
Opening file (1)
Opening file (1)
Opening file (1)
Opening file (1)
Opening file (1)
Opening file (2)
Opening file (2)
Opening file (2)
Opening file (2)
Opening file (3)
Opening file (3)
Opening file (3)
Opening file (3)
Opening file (4)
Opening file (4)
Opening file (4)
Opening file (4)
Opening file (5)
Opening file (5)
Opening file (5)
Opening file (5)
Opening file (2)
Opening file (2)
Opening file (2)
Opening file (2)
Opening file (3)
Opening file (3)
Opening file (3)
Opening file (3)
Opening file (4)
Opening file (4)
Opening file (4)
Opening file (4)
 - 137s - loss: 6.9009 - val_loss: 6.8346
Epoch 2/10
Opening file (6)
Opening file (6)
Opening file (6)
Opening file (6)
Opening file (7)
Opening file (7)
Opening file (7)
Opening file (7)
Opening file (8)
Opening file (8)
Opening file (8)
Opening file (8)
Opening file (9)
Opening file (9)
Opening file (9)
Opening file (9)
Opening file (10)
Opening file (10)
Opening file (10)
Opening file (10)
Opening file (5)
Opening file (5)
Opening file (5)
Opening file (5)
Opening file (6)
Opening file (6)
Opening file (6)
Opening file (6)
Opening file (7)
Opening file (7)
Opening file (7)
Opening file (7)
Opening file (8)
Opening file (8)
Opening file (8)
Opening file (8)
 - 137s - loss: 6.7199 - val_loss: 6.7390
Epoch 3/10
Opening file (11)
Opening file (11)
Opening file (11)
Opening file (11)
Opening file (12)
Opening file (12)
Opening file (12)
Opening file (12)
Opening file (13)
Opening file (13)
Opening file (13)
Opening file (13)
Opening file (14)
Opening file (14)
Opening file (14)
Opening file (14)
Opening file (15)
Opening file (15)
Opening file (15)
Opening file (15)
Opening file (9)
Opening file (9)
Opening file (9)
Opening file (9)
Opening file (10)
Opening file (10)
Opening file (10)
Opening file (10)
Opening file (11)
Opening file (11)
Opening file (11)
Opening file (11)
Opening file (12)
Opening file (12)
Opening file (12)
Opening file (12)
 - 133s - loss: 6.6313 - val_loss: 6.7135
Epoch 4/10
Opening file (16)
Opening file (16)
Opening file (16)
Opening file (16)
Opening file (17)
Opening file (17)
Opening file (17)
Opening file (17)
Opening file (18)
Opening file (18)
Opening file (18)
Opening file (18)
Opening file (19)
Opening file (19)
Opening file (19)
Opening file (19)
Opening file (20)
Opening file (20)
Opening file (20)
Opening file (20)
Opening file (13)
Opening file (13)
Opening file (13)
Opening file (13)
Opening file (14)
Opening file (14)
Opening file (14)
Opening file (14)
Opening file (15)
Opening file (15)
Opening file (15)
Opening file (15)
Opening file (16)
Opening file (16)
Opening file (16)
Opening file (16)
 - 133s - loss: 6.5612 - val_loss: 6.6958
Epoch 5/10
Opening file (21)
Opening file (21)
Opening file (21)
Opening file (21)
Opening file (22)
Opening file (22)
Opening file (22)
Opening file (22)
Opening file (23)
Opening file (23)
Opening file (23)
Opening file (23)
Opening file (24)
Opening file (24)
Opening file (24)
Opening file (24)
Opening file (17)
Opening file (17)
Opening file (17)
Opening file (17)
Opening file (18)
Opening file (18)
Opening file (18)
Opening file (18)
Opening file (19)
Opening file (19)
Opening file (19)
Opening file (19)
Opening file (20)
 - 140s - loss: 6.5184 - val_loss: 6.6750
Epoch 6/10
Opening file (25)
Opening file (25)
Opening file (25)
Opening file (25)
Opening file (26)
Opening file (26)
Opening file (26)
Opening file (26)
Opening file (27)
Opening file (27)
Opening file (27)
Opening file (27)
Opening file (28)
Opening file (28)
Opening file (28)
Opening file (28)
Opening file (29)
Opening file (29)
Opening file (29)
Opening file (29)
Opening file (20)
Opening file (20)
Opening file (20)
Opening file (21)
Opening file (21)
Opening file (21)
Opening file (21)
Opening file (22)
Opening file (22)
Opening file (22)
Opening file (22)
Opening file (23)
Opening file (23)
Opening file (23)
Opening file (23)
 - 137s - loss: 6.4811 - val_loss: 6.6569
Epoch 7/10
Opening file (30)
Opening file (30)
Opening file (30)
Opening file (30)
Opening file (31)
Opening file (31)
Opening file (31)
Opening file (31)
Opening file (32)
Opening file (32)
Opening file (32)
Opening file (32)
Opening file (33)
Opening file (33)
Opening file (33)
Opening file (33)
Opening file (34)
Opening file (34)
Opening file (34)
Opening file (34)
Opening file (24)
Opening file (24)
Opening file (24)
Opening file (24)
Opening file (25)
Opening file (25)
Opening file (25)
Opening file (25)
Opening file (26)
Opening file (26)
Opening file (26)
Opening file (26)
Opening file (27)
Opening file (27)
Opening file (27)
Opening file (27)
 - 143s - loss: 6.4445 - val_loss: 6.6438
Epoch 8/10
Opening file (35)
Opening file (35)
Opening file (35)
Opening file (35)
Opening file (36)
Opening file (36)
Opening file (36)
Opening file (36)
Opening file (37)
Opening file (37)
Opening file (37)
Opening file (37)
Opening file (38)
Opening file (38)
Opening file (38)
Opening file (38)
Opening file (39)
Opening file (39)
Opening file (39)
Opening file (39)
Opening file (28)
Opening file (28)
Opening file (28)
Opening file (28)
Opening file (29)
Opening file (29)
Opening file (29)
Opening file (29)
Opening file (30)
Opening file (30)
Opening file (30)
Opening file (30)
Opening file (31)
Opening file (31)
Opening file (31)
Opening file (31)
 - 144s - loss: 6.4072 - val_loss: 6.6323
Epoch 9/10
Opening file (40)
Opening file (40)
Opening file (40)
Opening file (40)
Opening file (41)
Opening file (41)
Opening file (41)
Opening file (41)
Opening file (42)
Opening file (42)
Opening file (42)
Opening file (42)
Opening file (43)
Opening file (43)
Opening file (43)
Opening file (43)
Opening file (32)
Opening file (32)
Opening file (32)
Opening file (32)
Opening file (33)
Opening file (33)
Opening file (33)
Opening file (33)
Opening file (34)
Opening file (34)
Opening file (34)
Opening file (34)
Opening file (35)
Opening file (35)
Opening file (35)
Opening file (35)
 - 144s - loss: 6.3871 - val_loss: 6.6308
Epoch 10/10
Opening file (44)
Opening file (44)
Opening file (44)
Opening file (44)
Opening file (45)
Opening file (45)
Opening file (45)
Opening file (45)
Opening file (46)
Opening file (46)
Opening file (46)
Opening file (46)
Opening file (47)
Opening file (47)
Opening file (47)
Opening file (47)
Opening file (48)
Opening file (48)
Opening file (48)
Opening file (48)
Opening file (36)
Opening file (36)
Opening file (36)
Opening file (36)
Opening file (37)
Opening file (37)
Opening file (37)
Opening file (37)
Opening file (38)
Opening file (38)
Opening file (38)
Opening file (38)
Opening file (39)
Opening file (39)
Opening file (39)
 - 145s - loss: 6.3685 - val_loss: 6.6097
[6.900854210567474, 6.71985878534317, 6.6312823179245, 6.5611836949348445, 6.518355902957916, 6.48112090883255, 6.444452247142792, 6.407157651996613, 6.387092570209504, 6.3685047111511235]
Opening file (1)
RNN with categorical cross entropy 0 batchs,  10  epochs in 1397.6723651885986 s
Last train cost :  6.541986300106048
recall :  0.0514522043933808
precision :  0.06915739268680471
sps :  0.07631160572337042
Best  sps :  0.07631160572337042
user_coverage :  0.4610492845786963
item_coverage :  135
ndcg :  0.07572232418873505
blockbuster_share :  0.3816091954022989
-----------------
Save model in /Users/xun/Documents/Thesis/Improving-RNN-recommendation-model/Dataset/ks-cooks-1y/models/ktf/rnn_cce_ml30_bs32_ne10_gc100_e8_h50_Ug_lr0.1_nt1.ktf

Process finished with exit code 0
